<div class="login-box">
    <form>
        <div class="form-group">
            <label for="exampleInputEmail1">이메일 주소</label>
            <input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp"
                   placeholder="email" th:value="${rememberMe}">
            <!-- remember id -->
            <small class="form-text text-muted">아이디 저장
                <input type="checkbox" id="remember" name="remember" th:checked="${rememberMe}">
            </small>
        </div>
        <div class="form-group">
            <label for="exampleInputPassword1">비밀번호</label>
            <input type="password" class="form-control" id="exampleInputPassword1" placeholder="Password"
                   maxlength="16">
        </div>
        <div class="form-buttons row">
            <div class="col-6">
                <button id="sign-up" type="button" class="btn">회원가입</button>
            </div>
            <div class="col-6">
                <button id="sign-in" type="submit" class="btn">로그인</button>
            </div>
        </div>
    </form>
</div>

<script>
    $('form').on('submit', function () {
        event.preventDefault();
        const email = $('#exampleInputEmail1').val();
        const password = $('#exampleInputPassword1').val();
        const remember = $('#remember').is(':checked');

        let data = {
            email: email,
            password: password,
            rememberMe: remember
        };

        const currentPageRequestParam = new URLSearchParams(window.location.search);
        const referer = currentPageRequestParam.get('referer');

        $.ajax({
            type: 'POST',
            url: '/login' + (referer ? '?referer=' + referer : ''),
            data: JSON.stringify(data),
            contentType: 'application/json; charset=utf-8',
            success: function (referer) {
                location.href = referer;
            }, error: function (error) {
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: '아이디 또는 비밀번호가 일치하지 않습니다.'
                })
            }
        })
    })
    $('#sign-up').on('click', function () {
        swal.fire({
            title: '회원가입',
            text: '회원가입은 준비중 입니다.',
            icon: 'info',
        });
    })
</script>
