<div class="duty-vue" v-cloak>
    <div th:if="${member.department}" class="calendar" th:attr="data-member_id=${member.id}">
        <div class="month-control row">
            <div class="month-control-left col-md-2">
                <div class="info department-info">
                    <i class="bi bi-people-fill"></i>
                    <span th:text="${member.department}"></span>
                </div>
            </div>
            <div class="col-md-8">
                <h1>
                    <a class="move h_pointer" v-on:click="addMonth(-1)">
                        <i class="bi bi-arrow-left-circle"></i>
                    </a>
                    <input id="month-selector" type="month" v-model="combinedYearMonth">
                    <a class="move h_pointer" v-on:click="addMonth(1)">
                        <i class="bi bi-arrow-right-circle"></i>
                    </a>
                </h1>
            </div>
            <div class="month-control-right col-md-2">
                <div class="info member-info">
                    <span th:text="${member.name}"></span>
                    <i class="bi bi-person-badge"></i>
                </div>
            </div>
        </div>
        <div class="dutyTypes">
    <span v-for="type in department.dutyTypes">
      <span :class="['indicator', 'BACKGROUND-' + type.color]">&nbsp;&nbsp;&nbsp;</span>
      <span v-text="type.name"></span>
    </span>
            <button v-if="canEdit && !batchEditMode"
                    class="edit-btn btn btn-warning"
                    v-on:click="batchEditMode=true;">편집
            </button>
            <button v-if="canEdit && batchEditMode"
                    class="edit-btn btn btn-success"
                    v-on:click="batchEditMode=false;">편집완료
            </button>
        </div>
        <ul class="weekdays">
            <li><abbr title="일요일">SUN</abbr></li>
            <li><abbr title="월요일">MON</abbr></li>
            <li><abbr title="화요일">TUE</abbr></li>
            <li><abbr title="수요일">WED</abbr></li>
            <li><abbr title="목요일">THU</abbr></li>
            <li><abbr title="금요일">FRI</abbr></li>
            <li><abbr title="토요일">SAT</abbr></li>
        </ul>

        <ol class="day-grid" :class="{'editable': canEdit}">
            <li v-for="(duty, index) in duties"
                :class="{
          ['BACKGROUND-' + duty.dutyColor]: true,
          'month-prev': (duty.month < month),
          'month-next': (duty.month > month),
          'today': isToday(duty),
          'holiday': isHoliday(index),
        }"
                v-on:click="viewDayDetail(duty, index)"
            >
                <div class="date container">
                    <div class="row day-header">
                        <div class="col-md-5">
                            <div class="day">
                                <span v-text="duty.day"></span>
                            </div>
                        </div>
                        <div class="col-md-7">
                            <span v-if="selectedDday" v-text="calcDday(duty)" class="d-day-count"></span>
                        </div>
                    </div>
                    <div v-if="!batchEditMode" class="schedules">
                        <div v-if="holidaysByDays[index]"
                             class="holiday-info"
                             v-for="holiday in holidaysByDays[index]">
                            <span :class="holiday.isHoliday ? 'holiday' : 'not-holiday'"
                                  v-text="holiday.dateName">

                            </span>
                        </div>
                        <div class="schedule" v-for="schedule in schedulesByDays[index]">
                            <span class="schedule-content" v-html="printSchedule(schedule)"></span>
                        </div>
                    </div>
                    <div v-if="batchEditMode" class="duty row">
                        <button v-for="type in department.dutyTypes"
                                class="duty-type btn btn-sm btn-outline-dark"
                                v-text="type.name.length > 3 ? type.name.substring(0, 3) : type.name"
                                :class="dutyTypeClasses(type, duty)"
                                :disabled="(duty.dutyType == type.name) || (!duty.dutyType && !type.id)"
                                v-on:click="changeDutyType(duty, type)"
                        >
                        </button>
                    </div>
                </div>
            </li>
        </ol>
        <div class="d-day-list row">
            <div v-for="(dDay, index) in dDays" class="col-6">
                <div class="d-day-item card row"
                     v-on:click="dDayToggle(dDay)"
                     :data-id="dDay.id"
                     :class="{'d-day-private': dDay.isPrivate, 'selected': dDay == selectedDday}"
                >
                    <div class="d-day_day col-4">
                        <span v-if="!dDay.editMode">{{dDay.dDayText}}</span>
                    </div>
                    <div class="d-day_content col-8">
                        <p v-if="!dDay.editMode">{{dDay.date}}</p>
                        <p v-if="!dDay.editMode">{{dDay.title}}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div th:if="!${member.department}" class="no-data p-5">
        <h3>어느 부서에도 소속되어 있지 않습니다.</h3>
    </div>

    <div id="detail-view-modal" class="modal fade" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content" v-if="detailView">
                <div class="modal-header">
                    <p class="current-date-label"
                       v-text="detailView?.year + '년 ' + detailView?.month + '월 ' + detailView?.day + '일'"></p>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="dutyTypes">
                        <form>
                            <div v-for="type in department.dutyTypes" class="pretty p-icon p-round p-jelly">
                                <input type="radio" name="dutyType"
                                       :checked="isDutyType(detailView, type)"
                                       v-on:click="changeDutyType(detailView, type)"
                                />
                                <div class="state p-primary">
                                    <i class="icon mdi mdi-check"></i>
                                    <label v-text="type.name"></label>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="schedules mt-4">
                        <div class="schedule card shadow"
                             v-for="(schedule, s_index) in schedulesByDays[detailView.index]">
                            <span v-html="printSchedule(schedule)"></span>
                            <div v-if="isEditing(schedule)" class="schedule-edit">
                                <input type="text" class="form-control" placeholder="일정을 입력하세요."
                                       v-model="editingSchedule.content"/>
                                <label>시작일</label>
                                <input type="datetime-local" class="form-control"
                                       v-model="editingSchedule.startDateTime"/>
                                <label>종료일</label>
                                <input type="datetime-local" class="form-control"
                                       v-model="editingSchedule.endDateTime"/>
                            </div>
                            <div class="buttons mt-3" v-if="!isEditing(schedule)">
                                <template
                                        v-if="schedulesByDays[detailView.index].length > detailView.scheduleStartDiffCount + 1 && dutyAndDateTimeSame(detailView, schedule.startDateTime)">
                                    <button :disabled="s_index == schedulesByDays[detailView.index].length -1"
                                            v-on:click="swapSchedule(schedule, schedulesByDays[detailView.index][s_index+1])"
                                            class="btn btn-secondary"
                                    >
                                        <i class="bi bi-arrow-down-square"></i>
                                    </button>
                                    <button :disabled="s_index <= detailView.scheduleStartDiffCount"
                                            v-on:click="swapSchedule(schedule, schedulesByDays[detailView.index][s_index-1])"
                                            class="btn btn-secondary">
                                        <i class="bi bi-arrow-up-square"></i>
                                    </button>
                                </template>
                                </button>
                                <button class="btn btn-info" v-on:click="scheduleEditMode(schedule)">수정</button>
                                <button class="btn btn-danger" v-on:click="deleteSchedule(schedule)">삭제</button>
                            </div>
                            <div class="buttons mt-3" v-if="isEditing(schedule)">
                                <button class="btn btn-success" v-on:click="editSchedule()">저장</button>
                                <button class="btn btn-secondary" v-on:click="cancelEditMode()">취소</button>
                            </div>
                        </div>
                        <div class="schedule schedule-add-button card shadow"
                             v-if="!isCreateScheduleMode && !editingSchedule.id">
                            <button class="btn btn-success" v-on:click="scheduleCreateMode()">일정 추가</button>
                        </div>
                        <div class="schedule schedule-add card shadow" v-if="isCreateScheduleMode">
                            <label>일정 추가</label>
                            <input type="text" class="form-control" placeholder="일정을 입력하세요."
                                   v-model="createSchedule.content"/>
                            <label>시작일</label>
                            <input type="datetime-local" class="form-control"
                                   v-model="createSchedule.startDateTime"/>
                            <label>종료일</label>
                            <input type="datetime-local" class="form-control" v-model="createSchedule.endDateTime"
                                   :min="createSchedule.startDateTime"/>
                            <div class="buttons mt-3">
                                <button class="btn btn-success" v-on:click="saveSchedule">추가</button>
                                <button class="btn btn-secondary" v-on:click="cancelCreateSchedule">취소</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                </div>
            </div>
        </div>
    </div>

</div>

<script>
    $(function () {
        if (document.querySelector('.calendar')) {
            const memberId = parseInt("[[${member.id}]]");
            const departmentId = parseInt("[[${member.departmentId}]]");
            const loginMemberId = parseInt("[[${loginMember?.id}]]");
            const managerId = parseInt("[[${member.managerId}]]");

            const app = new Vue({
                    el: '.duty-vue',
                    data: {
                        year: parseInt("[[${year}]]"),
                        month: parseInt("[[${month}]]"),
                        duties: [],
                        schedulesByDays: [],
                        holidaysByDays: [],
                        department: {},
                        dDays: [],
                        selectedDday: null,
                        detailView: null,
                        batchEditMode: false,
                        isCreateScheduleMode: false,
                        createSchedule: {
                            content: '',
                            startDateTime: '',
                            endDateTime: '',
                        },
                        editingSchedule: {
                            id: '',
                            content: '',
                            startDateTime: '',
                            endDateTime: '',
                        },
                    }, mounted() {
                        this.loadDuties(this.year, this.month);
                        this.loadSchedule(this.year, this.month);
                        this.loadDepartment();
                        this.loadDDays();
                        this.loadHolidays(this.year, this.month);
                    }, computed: {
                        combinedYearMonth: {
                            get() {
                                return `${this.year}-${this.month.toString().padStart(2, '0')}`;
                            },
                            set(value) {
                                if (!value) {
                                    value = new Date().toISOString().slice(0, 7);
                                    document.getElementById('month-selector').value = value;
                                }
                                const [year, month] = value.split('-');
                                this.year = parseInt(year);
                                this.month = parseInt(month);
                            },
                        },
                        canEdit() {
                            return loginMemberId == memberId || loginMemberId == managerId;
                        },
                        calcDday() {
                            return (duty) => {
                                const date = new Date(duty.year, duty.month - 1, duty.day);
                                const calc = Math.floor((date.getTime() - new Date(app.selectedDday.date).getTime()) / (1000 * 60 * 60 * 24)) + 1;
                                const dDayText = calc < 0 ? 'D' + calc : calc == 0 ? 'D-Day' : 'D+' + (calc + 1);
                                return dDayText;
                            }
                        },
                        printSchedule() {
                            return (schedule) => {
                                let content = schedule.content;
                                if (schedule.totalDays > 1) {
                                    content += '[' + schedule.daysFromStart + '/' + schedule.totalDays + '] ';
                                }
                                return content + '<small>' + app.printScheduleTime(schedule) + '</small>';
                            }
                        },
                        printScheduleTime() {
                            return (schedule) => {
                                let result = '';
                                if (app.shouldDisplayStartTime(schedule)) {
                                    const startTime = app.formattedTime(schedule.startDateTime);
                                    result += '(' + startTime;
                                    if (app.shouldDisplayEndTime(schedule)) {
                                        const endTime = app.formattedTime(schedule.endDateTime);
                                        return result + '~' + endTime + ')';
                                    }
                                    return result + ')';
                                }

                                if (app.shouldDisplayEndTime(schedule)) {
                                    const endTime = app.formattedTime(schedule.endDateTime);
                                    return result + ' (~' + endTime + ')';
                                }
                                return result;
                            }
                        },
                        shouldDisplayStartTime() {
                            return (schedule) => {
                                const daysFromStart = schedule.daysFromStart;
                                const startDateTime = new Date(schedule.startDateTime);
                                const startHour = startDateTime.getHours().toString().padStart(2, '0');
                                return daysFromStart === 1 && startHour !== '00';
                            }
                        },
                        shouldDisplayEndTime() {
                            return (schedule) => {
                                const daysFromStart = schedule.daysFromStart;
                                const totalDays = schedule.totalDays;
                                const startDateTime = new Date(schedule.startDateTime);
                                const endDateTime = new Date(schedule.endDateTime);
                                const endHour = endDateTime.getHours().toString().padStart(2, '0');
                                return (daysFromStart === totalDays) && (endHour !== '00') &&
                                    !(totalDays === 1 && sameDateTime(startDateTime, endDateTime));
                            }
                        },
                        dutyAndDateTimeSame() {
                            return (duty, dateTimeString) => {
                                const year = duty.year;
                                const month = duty.month - 1;
                                const day = duty.day;
                                const dateTime = new Date(dateTimeString);
                                return year === dateTime.getFullYear() && month === dateTime.getMonth() && day === dateTime.getDate();
                            }
                        }
                    }, watch: {
                        combinedYearMonth() {
                            this.loadDuties(app.year, app.month);
                            this.loadSchedule(app.year, app.month);
                            this.loadHolidays(app.year, app.month);
                            const currentUrl = new URL(window.location.href);
                            currentUrl.searchParams.set('year', app.year);
                            currentUrl.searchParams.set('month', app.month);
                            window.history.replaceState(null, '', currentUrl.toString());
                        },
                        'createSchedule.startDateTime': function () {
                            if (app.createSchedule.startDateTime > app.createSchedule.endDateTime) {
                                app.createSchedule.endDateTime = app.createSchedule.startDateTime;
                            }
                        },
                        'editingSchedule.startDateTime': function () {
                            if (app.editingSchedule.startDateTime > app.editingSchedule.endDateTime) {
                                app.editingSchedule.endDateTime = app.editingSchedule.startDateTime;
                            }
                        }
                    }, methods: {
                        addMonth(month) {
                            const newDate = new Date(app.year, app.month - 1 + month);
                            app.year = newDate.getFullYear();
                            app.month = newDate.getMonth() + 1;
                        },
                        loadDuties(year, month) {
                            $.ajax({
                                url: '/api/duty',
                                type: 'GET',
                                data: {
                                    memberId: memberId,
                                    year: year,
                                    month: month,
                                },
                                success: (data) => {
                                    this.duties = data;
                                }
                            })
                        },
                        loadDDays() {
                            const selectedDdayId = localStorage.getItem('selectedDday_' + memberId);
                            $.ajax({
                                url: '/api/dday/' + memberId,
                                type: 'GET',
                                success: (data) => {
                                    this.dDays = data;
                                    for (const dDay of app.dDays) {
                                        if (dDay.id == selectedDdayId) {
                                            app.selectedDday = dDay;
                                        }
                                        if (dDay.calc == 0) {
                                            dDay.dDayText = 'D-Day';
                                        } else if (dDay.calc < 0) {
                                            dDay.dDayText = 'D+' + -dDay.calc;
                                        } else {
                                            dDay.dDayText = 'D-' + dDay.calc;
                                        }
                                    }
                                }
                            })
                        },
                        dDayToggle(dDay) {
                            if (app.selectedDday == dDay) {
                                app.selectedDday = null;
                                localStorage.removeItem('selectedDday_' + memberId);
                            } else {
                                app.selectedDday = dDay;
                                localStorage.setItem('selectedDday_' + memberId, dDay.id);
                            }
                        },
                        loadSchedule(year, month) {
                            $.ajax({
                                url: '/api/schedules',
                                type: 'GET',
                                data: {
                                    memberId: memberId,
                                    year: year,
                                    month: month,
                                },
                                success: (data) => {
                                    this.schedulesByDays = data;
                                }
                            })
                        },
                        loadDepartment() {
                            fetch(`/api/departments/${departmentId}`)
                                .then(response => response.json())
                                .then(data => {
                                    this.department = data;
                                })
                        },
                        editDuty() {
                            const memberId = document.getElementsByClassName('calendar')[0].getAttribute('data-member_id');
                            window.location.href = `/duty/edit?memberId=${memberId}&year=${(app.year)}&month=${(app.month)}`;
                        },
                        formattedTime(timeString) {
                            const dateTime = new Date(timeString);
                            const hour = dateTime.getHours() == 12 ? 12 : dateTime.getHours() % 12;
                            let minute = '';
                            if (dateTime.getMinutes() != 0) {
                                minute = ':' + dateTime.getMinutes().toString().padStart(2, '0');
                            }
                            return hour + minute + (dateTime.getHours() >= 12 ? 'PM ' : 'AM');
                        }, isToday(duty) {
                            const today = new Date();
                            return duty.year === today.getFullYear() && duty.month === today.getMonth() + 1 && duty.day === today.getDate();
                        }, isHoliday(index) {
                            const holidays = app.holidaysByDays[index];
                            if (!holidays || holidays.length === 0) {
                                return false;
                            }
                            for (const holiday of holidays) {
                                if (holiday.isHoliday)
                                    return true;
                            }
                            return false;
                        }, viewDayDetail(duty, index) {
                            if (app.batchEditMode || !app.canEdit) {
                                return;
                            }
                            app.isCreateScheduleMode = false;
                            $('#detail-view-modal').modal('show');
                            app.detailView = duty;
                            app.detailView.index = index;
                            app.detailView.scheduleStartDiffCount = app.schedulesByDays[index].length;
                            for (const schedule of app.schedulesByDays[index]) {
                                if (app.dutyAndDateTimeSame(duty, schedule.startDateTime)) {
                                    app.detailView.scheduleStartDiffCount--;
                                }
                            }
                            app.resetCreateSchedule();
                            app.cancelEditMode();
                        }, resetCreateSchedule() {
                            app.createSchedule = {
                                content: '',
                                startDateTime: app.formattedDateTime(app.detailView),
                                endDateTime: app.formattedDateTime(app.detailView),
                            }
                        }, isDutyType(duty, dutyType) {
                            if (duty?.dutyType) {
                                return dutyType.name == duty.dutyType
                            }
                            return !dutyType.id
                        }, changeDutyType(duty, type) {
                            $.ajax({
                                url: '/api/duty/change',
                                type: 'PUT',
                                data: JSON.stringify({
                                    year: duty.year,
                                    month: duty.month,
                                    day: duty.day,
                                    dutyTypeId: type.id,
                                    memberId: memberId,
                                }),
                                contentType: 'application/json',
                                success: (data) => {
                                    duty.dutyType = type.name;
                                    duty.dutyColor = type.color;
                                },
                                fail: (data) => {
                                    Swal.fire({
                                        icon: 'error',
                                        title: '저장에 실패했습니다.',
                                        showConfirmButton: false,
                                        timer: 1500
                                    });
                                }
                            })
                        }, formattedDateTime(duty) {
                            const month = duty.month.toString().padStart(2, '0');
                            const day = duty.day.toString().padStart(2, '0');
                            return `${duty.year}-${month}-${day}T00:00`;
                        }, scheduleCreateMode() {
                            app.cancelEditMode();
                            app.isCreateScheduleMode = true;
                        }, cancelCreateSchedule() {
                            app.isCreateScheduleMode = false;
                            app.resetCreateSchedule();
                        }, saveSchedule() {
                            if (!isValidContent(app.createSchedule.content)) {
                                return;
                            }
                            if (!isValidDateTime(app.createSchedule.startDateTime, app.createSchedule.endDateTime)) {
                                return;
                            }
                            $.ajax({
                                url: '/api/schedules',
                                type: 'POST',
                                data: JSON.stringify({
                                    memberId: memberId,
                                    content: app.createSchedule.content,
                                    startDateTime: toLocalISOString(new Date(app.createSchedule.startDateTime)),
                                    endDateTime: toLocalISOString(new Date(app.createSchedule.endDateTime)),
                                }),
                                contentType: 'application/json',
                                success: (data) => {
                                    // SAVED
                                    app.resetCreateSchedule();
                                    app.loadSchedule(app.year, app.month);
                                    app.isCreateScheduleMode = false;
                                },
                                error: (data) => {
                                    Swal.fire({
                                        icon: 'error',
                                        title: '저장에 실패했습니다.',
                                        showConfirmButton: false,
                                        timer: 1500
                                    });
                                }
                            })
                        }, scheduleEditMode(schedule) {
                            app.cancelCreateSchedule();
                            app.editingSchedule.id = schedule.id;
                            app.editingSchedule.content = schedule.content;
                            app.editingSchedule.startDateTime = schedule.startDateTime;
                            app.editingSchedule.endDateTime = schedule.endDateTime;
                        }, cancelEditMode() {
                            app.editingSchedule.id = null;
                            app.editingSchedule.content = '';
                            app.editingSchedule.startDateTime = '';
                            app.editingSchedule.endDateTime = '';
                        },
                        isEditing(schedule) {
                            return app.editingSchedule.id === schedule.id;
                        },
                        editSchedule() {
                            const schedule = app.editingSchedule;
                            if (!isValidContent(schedule.content)) {
                                return;
                            }
                            if (!isValidDateTime(schedule.startDateTime, schedule.endDateTime)) {
                                return;
                            }

                            $.ajax({
                                url: '/api/schedules/' + schedule.id,
                                type: 'PUT',
                                data: JSON.stringify({
                                    content: schedule.content,
                                    startDateTime: toLocalISOString(new Date(schedule.startDateTime)),
                                    endDateTime: toLocalISOString(new Date(schedule.endDateTime)),
                                    memberId: memberId,
                                }),
                                contentType: 'application/json',
                                success: (data) => {
                                    app.cancelEditMode();
                                    app.loadSchedule(app.year, app.month);
                                },
                                error: (data) => {
                                    Swal.fire({
                                        icon: 'error',
                                        title: '저장에 실패했습니다.',
                                        showConfirmButton: false,
                                        timer: 1500
                                    });
                                }
                            })
                        },
                        swapSchedule(schedule1, schedule2) {
                            $('.schedules').waitMe();
                            if (!schedule1 || !schedule2 || schedule1 == schedule2) {
                                return;
                            }
                            fetch(`/api/schedules/${schedule1.id}/position?id2=${schedule2.id}`, {
                                method: 'PATCH',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                            }).then((response) => {
                                $('.schedules').waitMe('hide');
                                if (response.ok) {
                                    app.loadSchedule(app.year, app.month);
                                } else {
                                    Swal.fire({
                                        icon: 'error',
                                        title: '순서 변경에 실패했습니다.',
                                        showConfirmButton: false,
                                        timer: 1500
                                    });
                                }
                            });
                        },
                        deleteSchedule(schedule) {
                            Swal.fire({
                                title: '일정을 삭제하시겠습니까?',
                                text: "삭제된 일정은 복구할 수 없습니다.",
                                icon: 'warning',
                                showCancelButton: true,
                                confirmButtonColor: '#d33',
                                cancelButtonColor: '#999',
                                confirmButtonText: '삭제',
                                cancelButtonText: '취소',
                            }).then((result) => {
                                if (result.isConfirmed) {
                                    $.ajax({
                                        url: '/api/schedules/' + schedule.id,
                                        type: 'DELETE',
                                        success: (data) => {
                                            app.loadSchedule(app.year, app.month);
                                        },
                                        error: (data) => {
                                            Swal.fire({
                                                icon: 'error',
                                                title: '삭제에 실패했습니다.',
                                                showConfirmButton: false,
                                                timer: 1500
                                            });
                                        }
                                    })
                                }
                            })
                        },
                        dutyTypeClasses(type, duty) {
                            const departmentLength = app.department.dutyTypes.length;
                            const colClass = (departmentLength === 2 || departmentLength === 4) ? 'col-md-6' : 'col-md-4';
                            return {
                                ['BACKGROUND-' + type.color]: true,
                                selected: type.id === duty.dutyTypeId,
                                [colClass]: true,
                            };
                        },
                        changeDutyType(duty, type) {
                            $.ajax({
                                url: '/api/duty/change',
                                type: 'PUT',
                                data: JSON.stringify({
                                    year: duty.year,
                                    month: duty.month,
                                    day: duty.day,
                                    dutyTypeId: type.id,
                                    memberId: memberId,
                                }),
                                contentType: 'application/json',
                                success: (data) => {
                                    duty.dutyType = type.name;
                                    duty.dutyColor = type.color;
                                },
                                fail: (data) => {
                                    Swal.fire({
                                        icon: 'error',
                                        title: '저장에 실패했습니다.',
                                        showConfirmButton: false,
                                        timer: 1500
                                    });
                                }
                            })
                        },
                        async loadHolidays(year, month) {
                            const response = await fetch(`/api/holidays?year=${year}&month=${month}`);

                            if (!response.ok) {
                                console.log(`Error loading holidays. Status Code: ${response.status}`);
                                return;
                            }

                            this.holidaysByDays = await response.json();
                        }
                    }
                }
            )
        }
    })

    function sameDateTime(startDateTime, endDateTime) {
        return startDateTime.getTime() == endDateTime.getTime();
    }

    function isValidContent(content) {
        if (!content) {
            Swal.fire({
                icon: 'error',
                title: '내용을 입력해주세요.',
                showConfirmButton: false,
                timer: 1500
            });
            return false;
        }
        return true;
    }

    function isValidDateTime(startDateTime, endDateTime) {
        if (!startDateTime || !endDateTime) {
            Swal.fire({
                icon: 'error',
                title: '시작일시와 종료일시를 모두 입력해주세요.',
                showConfirmButton: false,
                timer: 1500
            });
            return false;
        }
        if (new Date(startDateTime) > new Date(endDateTime)) {
            Swal.fire({
                icon: 'error',
                title: '종료일시는 시작일시보다 빠를 수 없습니다.',
                showConfirmButton: false,
                timer: 1500
            });
            return false;
        }
        return true;
    }

</script>
